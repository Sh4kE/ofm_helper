{% extends "core/base.html" %}

{% block content %}
    {% load staticfiles %}

    <h1 class="page-header">
        Transfers
    </h1>

    <div id="transfers-toolbar">

        <div id="TransferPositionFilter" class="dropdown">
            <button id="positionFilterLabel" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Positionen
                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="positionFilterLabel">
                <li><a href="#" data-value="All">Alle</a></li>
                <li><a href="#" data-value="TW">TW</a></li>
                <li><a href="#" data-value="LIB">LIB</a></li>
                <li><a href="#" data-value="LV">LV</a></li>
                <li><a href="#" data-value="LMD">LMD</a></li>
                <li><a href="#" data-value="RMD">RMD</a></li>
                <li><a href="#" data-value="RV">RV</a></li>
                <li><a href="#" data-value="VS">VS</a></li>
                <li><a href="#" data-value="LM">LM</a></li>
                <li><a href="#" data-value="DM">DM</a></li>
                <li><a href="#" data-value="ZM">ZM</a></li>
                <li><a href="#" data-value="RM">RM</a></li>
                <li><a href="#" data-value="LS">LS</a></li>
                <li><a href="#" data-value="MS">MS</a></li>
                <li><a href="#" data-value="RS">RS</a></li>
            </ul>
        </div>

        <div id="TransferAgeFilter" class="dropdown">
            <button id="AgeFilterLabel" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Alter
                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="positionFilterLabel">
                <li><a href="#" data-value="17">17</a></li>
                <li><a href="#" data-value="18">18</a></li>
                <li><a href="#" data-value="19">19</a></li>
                <li><a href="#" data-value="20">20</a></li>
                <li><a href="#" data-value="21">21</a></li>
                <li><a href="#" data-value="22">22</a></li>
                <li><a href="#" data-value="23">23</a></li>
                <li><a href="#" data-value="24">24</a></li>
                <li><a href="#" data-value="25">25</a></li>
                <li><a href="#" data-value="26">26</a></li>
                <li><a href="#" data-value="27">27</a></li>
                <li><a href="#" data-value="28">28</a></li>
                <li><a href="#" data-value="29">29</a></li>
                <li><a href="#" data-value="30">30</a></li>
                <li><a href="#" data-value="31">31</a></li>
                <li><a href="#" data-value="32">32</a></li>
                <li><a href="#" data-value="33">33</a></li>
                <li><a href="#" data-value="34">34</a></li>
                <li><a href="#" data-value="35">35</a></li>
                <li><a href="#" data-value="36">36</a></li>
            </ul>
        </div>

    </div>

    <script>
        var position = 'MS';
        var age = '32';

        var transfers_chart_options =  {
            chart: {
                type: 'boxplot',
                height: 650,
                zoomType: 'xy',
                panKey: 'ctrl',
                panning: true,
            },
            title: {
                text: 'Spielerpreise'
            },
            xAxis: {
                categories: [], // has to be overwritten
                title: {
                    text: 'St√§rke'
                }
            },
            yAxis: {
                title: {
                    text: 'Preis'
                }
            },
            plotOptions: {
                boxplot: {
                    fillColor: '#F0F0E0',
                    lineWidth: 1.5,
                    medianColor: '#24a52f',
                    medianWidth: 2,
                    stemWidth: 2,
                    whiskerColor: '#24a52f',
                    whiskerLength: '40%',
                }
            },
            series: [] // has to be overwritten
        };

        function requestChartData() {
            $.ajax({
                type: "GET",
                url: "{% url 'core:ofm:transfers_chart_json' %}",
                data: {
                    group_by: 'Strength',
                    positions: position,
                    // strengths: '14,15,16',
                    ages: age,
                    // min_price: min_price,
                    // max_price: max_price,
                    // matchdays: '0,1,2'
                },
                dataType: 'json',
                success: function (data) {
                    transfers_chart_options.series = data['series'];
                    transfers_chart_options.xAxis.categories = data['categories'];
                    $('#transfers_chart_container').highcharts(transfers_chart_options);
                }
            });
        }

        $("#TransferPositionFilter a").click(function(){
            position = $(this).attr('data-value');
            requestChartData();
        });

        $("#TransferAgeFilter a").click(function(){
            age = $(this).attr('data-value');
            requestChartData();
        });

        $(document).ready(function() {
            requestChartData();
        });
    </script>

    <br>
    <div id="transfers_chart_container"></div>
{% endblock %}
